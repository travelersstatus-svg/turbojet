<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aviator Pro Max</title>
    
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
      import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCrk8ksYM1Kt6ehT0TkDr3vjybjHDCyDgc",
        authDomain: "myaviatoregame.firebaseapp.com",
        projectId: "myaviatoregame",
        storageBucket: "myaviatoregame.firebasestorage.app",
        messagingSenderId: "286687400349",
        appId: "1:286687400349:web:e01e2cff439a3267de1f74"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth();
      const db = getFirestore();

      let multiplier = 1.00;
      let isFlying = false;
      let resultsHistory = [];

      // --- GAME ENGINE ---
      function runGame() {
        if(isFlying) return;
        isFlying = true;
        multiplier = 1.00;
        let crashAt = (Math.random() * 5 + 1.1).toFixed(2);
        
        let timer = setInterval(() => {
          multiplier += 0.01;
          const display = document.getElementById('multiplier-text');
          display.innerText = multiplier.toFixed(2) + "x";
          display.style.color = "white";

          if(multiplier >= crashAt) {
            clearInterval(timer);
            display.innerText = "FLEW AWAY!";
            display.style.color = "#ff0055";
            resultsHistory.unshift(multiplier.toFixed(2));
            if(resultsHistory.length > 30) resultsHistory.pop();
            updateHistory();
            isFlying = false;
            setTimeout(runGame, 3000);
          }
        }, 80);
      }

      function updateHistory() {
        const h = document.getElementById('hist-list');
        h.innerHTML = resultsHistory.map(r => `<span>${r}x</span>`).join('');
      }

      onAuthStateChanged(auth, (user) => {
        if(user) {
          document.getElementById('auth-screen').style.display = 'none';
          onSnapshot(doc(db, "users", user.uid), (d) => {
            if(d.exists()) document.getElementById('bal-text').innerText = d.data().balance.toFixed(2);
          });
          runGame();
        }
      });
    </script>

    <style>
        * { box-sizing: border-box; }
        body { background: #0a0e17; color: white; font-family: sans-serif; margin: 0; padding: 0; }
        
        /* Nav & Menu Fix */
        .header { background: #0f1521; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #252f44; }
        .nav-right { display: flex; align-items: center; gap: 12px; }
        .wallet { background: #000; border: 1px solid #28a745; padding: 4px 10px; border-radius: 20px; color: #28a745; font-weight: bold; }
        
        /* Side Menu (Right Side) */
        #side-menu { position: fixed; top: 0; right: -280px; width: 250px; height: 100%; background: #161d2b; z-index: 1000; transition: 0.3s; padding: 20px; border-left: 2px solid #ff0055; }
        
        /* History Dropdown */
        .history-section { background: #111827; padding: 8px 15px; cursor: pointer; border-bottom: 1px solid #222; font-size: 13px; }
        #hist-list { display: none; background: #0f1521; padding: 10px; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        #hist-list span { background: #1a2233; padding: 3px; border-radius: 8px; font-size: 11px; text-align: center; color: #9d50ff; }

        /* Multiplier Area */
        .game-screen { height: 230px; background: radial-gradient(circle at bottom, #1a2a44, #05080f); margin: 10px; border-radius: 15px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        #multiplier-text { font-size: 3.8rem; font-weight: 900; }

        /* Fake Table */
        .bets-table { margin: 10px; background: #161d2b; border-radius: 10px; padding: 10px; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; }
        th { color: #555; text-align: left; padding-bottom: 10px; }
        td { padding: 8px 0; border-bottom: 1px solid #1f2937; }

        /* Bet Cards */
        .controls { display: flex; gap: 10px; padding: 10px; }
        .card { background: #161d2b; flex: 1; padding: 12px; border-radius: 15px; border: 1px solid #252f44; }
        .bet-btn { width: 100%; padding: 12px; border: none; border-radius: 10px; font-weight: bold; color: white; cursor: pointer; margin-top: 10px; }
        .q-btn { background: #000; border: 1px solid #333; color: #fff; padding: 5px; font-size: 10px; border-radius: 5px; margin: 2px; }
    </style>
</head>
<body>

<div id="side-menu">
    <h3 style="color:#ff0055">MENU</h3>
    <p>ID: <span id="u-id">AV7721</span></p>
    <hr>
    <p>Transaction History</p>
    <p>Referral Code</p>
    <p style="color:red" onclick="location.reload()">Logout</p>
</div>

<div class="header">
    <div style="color:#ff0055; font-weight:900; font-size:20px;">AVIATOR</div>
    <div class="nav-right">
        <div class="wallet">₹<span id="bal-text">0.00</span> <span style="cursor:pointer">+</span></div>
        <div onclick="const m=document.getElementById('side-menu'); m.style.right=m.style.right==='0px'?'-280px':'0px'" style="font-size:25px; cursor:pointer">☰</div>
    </div>
</div>

<div class="history-section" onclick="const l=document.getElementById('hist-list'); l.style.display=l.style.display==='grid'?'none':'grid'">
    Past Results ▼
</div>
<div id="hist-list"></div>

<div class="game-screen">
    <div id="multiplier-text">1.00x</div>
</div>

<div class="controls">
    <div class="card">
        <div style="font-size:10px; color:gray">Auto Play <input type="checkbox"> Auto Cash <input type="checkbox"></div>
        <input type="number" id="amt-1" value="100" style="width:100%; background:#000; color:#fff; border:none; margin:5px 0; padding:5px;">
        <div style="display:flex; flex-wrap:wrap">
            <button class="q-btn" onclick="document.getElementById('amt-1').value=10">10</button>
            <button class="q-btn" onclick="document.getElementById('amt-1').value=100">100</button>
            <button class="q-btn" onclick="document.getElementById('amt-1').value=500">500</button>
            <button class="q-btn" onclick="document.getElementById('amt-1').value=1000">1000</button>
        </div>
        <button class="bet-btn" style="background:#28a745">BET</button>
    </div>
    <div class="card">
        <div style="font-size:10px; color:gray">Auto Play <input type="checkbox"> Auto Cash <input type="checkbox"></div>
        <input type="number" id="amt-2" value="100" style="width:100%; background:#000; color:#fff; border:none; margin:5px 0; padding:5px;">
        <div style="display:flex; flex-wrap:wrap">
            <button class="q-btn" onclick="document.getElementById('amt-2').value=10">10</button>
            <button class="q-btn" onclick="document.getElementById('amt-2').value=100">100</button>
            <button class="q-btn" onclick="document.getElementById('amt-2').value=500">500</button>
            <button class="q-btn" onclick="document.getElementById('amt-2').value=1000">1000</button>
        </div>
        <button class="bet-btn" style="background:#1267ff">BET</button>
    </div>
</div>

<div class="bets-table">
    <table>
        <thead><tr><th>User</th><th>Bet</th><th>Cash Out</th></tr></thead>
        <tbody id="fake-list"></tbody>
    </table>
</div>

<div id="auth-screen" style="position:fixed; inset:0; background:#0a0e17; z-index:10001; display:flex; align-items:center; justify-content:center;">
    <div style="background:#161d2b; padding:40px; border-radius:20px; text-align:center; width:85%">
        <h2 style="color:#ff0055">LOGIN</h2>
        <input id="auth-email" placeholder="Email" style="width:100%; padding:12px; margin:10px 0;">
        <input id="auth-pass" type="password" placeholder="Password" style="width:100%; padding:12px; margin:10px 0;">
        <button onclick="handleAuth()" style="width:100%; padding:12px; background:#28a745; border:none; color:white; font-weight:bold; border-radius:10px;">PROCEED</button>
    </div>
</div>

<script>
    const names = ["Rahul", "Amit", "Priya", "Vikram", "Soni", "Arjun"];
    function addFake() {
        const list = document.getElementById('fake-list');
        const name = names[Math.floor(Math.random()*names.length)] + "****";
        const amt = (Math.random()*500 + 10).toFixed(0);
        const mult = (Math.random()*2 + 1.1).toFixed(2);
        const row = `<tr><td>${name}</td><td>₹${amt}</td><td style="color:#28a745">${mult}x</td></tr>`;
        list.insertAdjacentHTML('afterbegin', row);
        if(list.children.length > 7) list.lastElementChild.remove();
    }
    setInterval(addFake, 2000);
</script>

</body>
</html>
